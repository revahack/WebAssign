<!DOCTYPE html>
<html>
    <head>
        <link href="./custom.css" rel="stylesheet">
        <title>
            Preview Email
        </title>
        <style>
            button:hover{
                opacity: 0.8;
            }
            button:focus{
                filter: hue-rotate(30deg);
            }
        </style>
    </head>
<body onload="getItems();">
    <div style="border-radius: 16px; font-family: 'system-ui'; width: 60%; display: block; margin: 10vh auto; padding: 2vh 3vw; background-color: #fcfcfc; box-shadow: 4px 6px 10px #acacac88, -4px -3px 10px #acacac88;">

        <h1 style="text-align: center;;">Generic Result Marksheet Board</h1><br/>
        <table style="font-size: 1.2em;">
            <tr>
                <td style="font-weight: bold; width: 160px;">Name</td><td><span id="firstName"></span> <span id="lastName"></span><br></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Gender</td><td><span id="gender"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Email</td><td><span id="emailAdd"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">DOB</td><td><span id="dob"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Age</td><td><span id="age"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Stream</td><td><span id="stream"></span></td>
            </tr>
        </table>

        <br/><br/><br/>

        <table id="itemsTable" style="font-size: 1.2em; border-collapse: collapse;">
            <tr style="background: #0065af; color: #fff;">
                <th style="padding: 6px 20px; width: 100px; text-align: center;">Serial</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Subject Name</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Max Marks</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Marks Received</th>
            </tr>
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">OOP</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;"><span id="oopMarks"></span></td>
            </tr>   
            <tr style="background: #ffffff;">
                <td style="text-align: center;">2</td>
                <td style="text-align: center;">SDLC</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;"><span id="sdlcMarks"></span></td>
            </tr>  
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">3</td>
                <td style="text-align: center;">DBMS</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;"><span id="dbmsMarks"></span></td>
            </tr>  
            <tr style="background: #ffffff;">
                <td style="text-align: center;">4</td>
                <td style="text-align: center;">OS</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;"><span id="osMarks"></span></td>
            </tr> 
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">5</td>
                <td style="text-align: center;">CN</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;"><span id="cnMarks"></span></td>
            </tr>   
        </table><br/><br/>
        <button onclick="sendEmail()" style="border-radius: 6px; margin: 20px 0; background: #0065af; color: #fcfcfc; border: none; padding: 8px 20px; font-size: 1.3em;">Send Email</button>
        <br/><br/>
        <h1 id="success" style="display: none;">Email Sent Succesfully</h1>
        <h1 id="failure" style="display: none;">Couldn't Send Email</h1>
    </div>
</body>
</html>

<script src="https://smtpjs.com/v3/smtp.js">
</script>

<script>
    function getItems(){
        document.getElementById("oopMarks").innerHTML = localStorage.getItem("OOP");
        document.getElementById("sdlcMarks").innerHTML = localStorage.getItem("SDLC");
        document.getElementById("dbmsMarks").innerHTML = localStorage.getItem("DBMS");
        document.getElementById("osMarks").innerHTML = localStorage.getItem("OS");
        document.getElementById("cnMarks").innerHTML = localStorage.getItem("CN");
        document.getElementById("firstName").innerHTML = localStorage.fname;
        document.getElementById("lastName").innerHTML = localStorage.lname;
        document.getElementById("gender").innerHTML = localStorage.gender;
        document.getElementById("emailAdd").innerHTML = localStorage.email;
        document.getElementById("dob").innerHTML = localStorage.dob;
        document.getElementById("age").innerHTML = localStorage.age;
        document.getElementById("stream").innerHTML = localStorage.stream;

        
        document.getElementById("oopMarks1").innerHTML = localStorage.getItem("OOP");
        document.getElementById("sdlcMarks1").innerHTML = localStorage.getItem("SDLC");
        document.getElementById("dbmsMarks1").innerHTML = localStorage.getItem("DBMS");
        document.getElementById("osMarks1").innerHTML = localStorage.getItem("OS");
        document.getElementById("cnMarks1").innerHTML = localStorage.getItem("CN");
        document.getElementById("firstName1").innerHTML = localStorage.fname;
        document.getElementById("lastName1").innerHTML = localStorage.lname;
        document.getElementById("gender1").innerHTML = localStorage.gender;
        document.getElementById("emailAdd1").innerHTML = localStorage.email;
        document.getElementById("dob1").innerHTML = localStorage.dob;
        document.getElementById("age1").innerHTML = localStorage.age;
        document.getElementById("stream1").innerHTML = localStorage.stream;
    }


function sendEmail() {

    var body = `
    <div style="border-radius: 16px; font-family: 'system-ui'; width: 60%; display: block; margin: 10vh auto; padding: 2vh 3vw; background-color: #fcfcfc; box-shadow: 4px 6px 10px #acacac88, -4px -3px 10px #acacac88;">

        <h1 style="text-align: center;;">Generic Result Marksheet Board</h1><br/>
        <table style="font-size: 1.2em;">
            <tr>
                <td style="font-weight: bold; width: 160px;">Name</td><td>${localStorage.fname} ${localStorage.lname}</span><br></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Gender</td><td>${localStorage.gender}</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Email</td><td>${localStorage.email}</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">DOB</td><td>${localStorage.dob}</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Age</td><td>${localStorage.age}</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Stream</td><td>${localStorage.stream}</td>
            </tr>
        </table>

        <br/><br/><br/>

        <table id="itemsTable" style="font-size: 1.2em; border-collapse: collapse;">
            <tr style="background: #0065af; color: #fff;">
                <th style="padding: 6px 20px; width: 100px; text-align: center;">Serial</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Subject Name</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Max Marks</th>
                <th style="padding: 6px 20px; width: 200px; text-align: center;">Marks Received</th>
            </tr>
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">OOP</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;">${localStorage.getItem("OOP")}</td>
            </tr>   
            <tr style="background: #ffffff;">
                <td style="text-align: center;">2</td>
                <td style="text-align: center;">SDLC</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;">${localStorage.getItem("SDLC")}</td>
            </tr>  
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">3</td>
                <td style="text-align: center;">DBMS</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;">${localStorage.getItem("DBMS")}</td>
            </tr>  
            <tr style="background: #ffffff;">
                <td style="text-align: center;">4</td>
                <td style="text-align: center;">OS</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;">${localStorage.getItem("OS")}</td>
            </tr> 
            <tr style="background: #f4f4f4;">
                <td style="text-align: center;">5</td>
                <td style="text-align: center;">CN</td>
                <td style="text-align: center;">100</td>
                <td style="text-align: center;">${localStorage.getItem("CN")}</td>
            </tr>   
        </table>
    </div>
    `
Email.send({
    Host : "smtp-mail.outlook.com",
    Username : "shivendra.intern@reva.edu.in",
    Password : "#Elipses12",
    To : localStorage.email,
    From : "shivendra.intern@reva.edu.in",
    Subject : "Test email",
    Body : body
}).then(
    message => console.log(message)
).then(
    document.getElementById("success").style.display = "block"
);
}
</script>
